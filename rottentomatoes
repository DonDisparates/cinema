from selenium import webdriver import time from webdriver_manager.chrome import ChromeDriverManager from selenium.webdriver.common.keys import Keys import pandas as pd
from bs4 import BeautifulSoup from contextlib import suppress from selenium.common.exceptions import NoSuchElementException from selenium.common.exceptions import WebDriverException import csv with open(r"C:\Users\usuario\Documents\9° Semestre\Practicum II\titulos.csv",newline="") as titulos: reader = csv.reader(titulos) films = list(titulos) df = pd.DataFrame() #films = ["Avengers: Endgame","Star Wars Ep. VII: The Force Awakens", "Sonic The Hedgehog"] #Rotten Tomatoes driver = webdriver.Chrome(ChromeDriverManager().install()) elem = [""] i=1428 #ciclo len(films) for i in range(1428,1480,1): with suppress(WebDriverException): with suppress(NoSuchElementException): driver.get("https://www.rottentomatoes.com/") time.sleep(2.5) film = [films[i]] driver.find_element_by_xpath("/html/body/div[4]/header/nav/search-algolia/search-algolia-controls/input").send_keys(film[0]) time.sleep(0.5) driver.find_element_by_xpath("/html/body/div[4]/header/nav/search-algolia/search-algolia-controls/input").send_keys(Keys.ENTER) time.sleep(1) elem = driver.find_elements_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/nav/ul/li[2]") if len(elem) > 0: driver.find_element_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/nav/ul/li[2]").click() time.sleep(1.5) elem = driver.find_elements_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/search-page-result[1]/ul/search-page-media-row/a[2]") if len(elem) > 0: driver.find_element_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/search-page-result[1]/ul/search-page-media-row/a[2]").click() time.sleep(1.5)
from bs4 import BeautifulSoup from contextlib import suppress from selenium.common.exceptions import NoSuchElementException from selenium.common.exceptions import WebDriverException import csv with open(r"C:\Users\usuario\Documents\9° Semestre\Practicum II\titulos.csv",newline="") as titulos: reader = csv.reader(titulos) films = list(titulos) df = pd.DataFrame() #films = ["Avengers: Endgame","Star Wars Ep. VII: The Force Awakens", "Sonic The Hedgehog"] #Rotten Tomatoes driver = webdriver.Chrome(ChromeDriverManager().install()) elem = [""] i=1428 #ciclo len(films) for i in range(1428,1480,1): with suppress(WebDriverException): with suppress(NoSuchElementException): driver.get("https://www.rottentomatoes.com/") time.sleep(2.5) film = [films[i]] driver.find_element_by_xpath("/html/body/div[4]/header/nav/search-algolia/search-algolia-controls/input").send_keys(film[0]) time.sleep(0.5) driver.find_element_by_xpath("/html/body/div[4]/header/nav/search-algolia/search-algolia-controls/input").send_keys(Keys.ENTER) time.sleep(1) elem = driver.find_elements_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/nav/ul/li[2]") if len(elem) > 0: driver.find_element_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/nav/ul/li[2]").click() time.sleep(1.5) elem = driver.find_elements_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/search-page-result[1]/ul/search-page-media-row/a[2]") if len(elem) > 0: driver.find_element_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/search-page-result[1]/ul/search-page-media-row/a[2]").click() time.sleep(1.5)
elem = driver.find_elements_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/nav/ul/li[3]") if len(elem) > 0: driver.find_element_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/nav/ul/li[3]").click() time.sleep(1.5) elem = driver.find_elements_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/search-page-result[2]/ul/search-page-media-row/a[2]") if len(elem) > 0: driver.find_element_by_xpath("/html/body/div[4]/main/div[1]/div/section[1]/search-page-result-container/search-page-result[2]/ul/search-page-media-row/a[2]").click() time.sleep(1.5) #Name film.append(driver.find_element_by_class_name("scoreboard__title").text) #Tomatometer x content = driver.page_source soup = BeautifulSoup(content, 'html.parser') #film.append("Tomatometer:"+soup.find("score-board")['tomatometerscore'])} film.append(soup.find("score-board")['tomatometerscore']) #Audience Score x #film.append("Audience Score:"+soup.find("score-board")['audiencescore']) film.append(soup.find("score-board")['audiencescore']) for j in range(0,4-len(film),1): film.append("NA") # print(film) df[film[0]] = film #time.sleep(2) print(i) df=df.transpose() df.to_csv(r"C:\Users\usuario\Documents\9° Semestre\Practicum II\TomatoeScore.csv",index=False)
