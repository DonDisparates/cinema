from selenium import webdriver import time from webdriver_manager.chrome import ChromeDriverManager import pandas as pd
from contextlib import suppress from selenium.common.exceptions import NoSuchElementException from selenium.common.exceptions import WebDriverException from selenium.webdriver.common.by import By import csv with open(r"C:\Users\usuario\Documents\9° Semestre\Practicum II\titulos.csv",newline="") as titulos: reader = csv.reader(titulos) films = list(titulos) df = pd.DataFrame() #IMDB driver = webdriver.Chrome(ChromeDriverManager().install()) #i=1 driver.get("https://www.imdb.com/") time.sleep(3) driver.find_element(By.XPATH,'//*[@id="imdbHeader"]/div[2]/div[6]/label').click() time.sleep(1) driver.find_element(By.XPATH,'//*[@id="language-option-en-US"]/span[2]').click() time.sleep(1) #ciclo len(films) for i in range(2000, 2177 ,1): with suppress(WebDriverException): with suppress(NoSuchElementException): film = [films[i]] driver.find_element(By.XPATH,'//*[@id="suggestion-search"]').send_keys(film[0]) time.sleep(1) driver.find_element(By.XPATH,'//*[@id="main"]/div/div[2]/table/tbody/tr[1]/td[2]/a').click() time.sleep(1) #Name film.append(driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[2]/div[1]/h1').text) #MPAA film.append(driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[2]/div[1]/div/ul/li[2]/a').text) #Runtime film.append(driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[2]/div[1]/div/ul/li[3]').text) #Metascore film.append(driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[3]/div[2]/div[2]/ul/li[3]/a/span/span[1]/span').text) #Directors film.append(driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[3]/div[2]/div[1]/div[3]/ul/li[1]/div').text) #Star1
film.append(driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[3]/div[2]/div[1]/div[3]/ul/li[3]/div/ul/li[1]/a').text) #Star2 film.append(driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[3]/div[2]/div[1]/div[3]/ul/li[3]/div/ul/li[2]/a').text) time.sleep(2) #IMDB Rating final driver.find_element(By.XPATH,'//*[@id="__next"]/main/div/section[1]/section/div[3]/section/section/div[2]/div[2]/div/div[1]/a/div/div/div[2]/div[1]/span[1]').click() time.sleep(2) film.append(driver.find_element(By.XPATH,'//*[@id="main"]/section/div/div[1]/div/div[2]/div[1]/span[2]').text) driver.find_element(By.XPATH,'//*[@id="main"]/section/div/div[1]/div/div[1]/h3/a').click() time.sleep(2) for j in range(0,9-len(film),1): film.append("NA") df[film[0]] = film time.sleep(2) print(i) df=df.transpose() df.to_csv(r"C:\Users\usuario\Documents\9° Semestre\Practicum II\IMDB.csv",index=False)
